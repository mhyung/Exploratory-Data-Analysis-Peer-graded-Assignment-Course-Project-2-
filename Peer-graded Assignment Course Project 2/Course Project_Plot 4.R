> setwd("~/Desktop") > NEI <- readRDS("summarySCC_PM25.rds") > SCC <- readRDS("Source_Classification_Code.rds")  > if(!exists("NEI")){NEI <- readRDS("./data/summarySCC_PM25.rds")} > if(!exists("SCC")){SCC <- readRDS("./data/Source_Classification_Code.rds")} > if(!exists("NEISCC")){NEISCC <- merge(NEI, SCC, by="SCC")} > library(ggplot2) > coalMatches  <- grepl("coal", NEISCC$Short.Name, ignore.case=TRUE) > subsetNEISCC <- NEISCC[coalMatches, ]  > TotalByYear <- aggregate(Emissions ~ year, subsetNEISCC, sum) > png('Plot4.png') > g1 <- ggplot(TotalByYear, aes(factor(year), Emissions))  > g2 <- g1 + geom_bar(stat="identity", fill ="#FF9999", width=0.75) + xlab("year") + ylab(expression('Total PM'[2.5]*" Emissions")) + ggtitle('Total Emissions from coal sources from 1999 to 2008') > print(g2)  > dev.off() 
